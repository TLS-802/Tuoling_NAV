<script type='text/javascript' id='popper-js-extra'>
var theme = {
    "ajaxurl":"",
    "addico":"https:\/\/nav.baidu.cn\/wp-content\/themes\/onenav\/images\/add.png",
    "order":"asc",
    "formpostion":"top",
    "defaultclass":"io-grey-mode",
    "isCustomize":"1",
    "icourl":"",
    "icopng":".png",
    "urlformat":"1",
    "customizemax":"10",
    "newWindow":"0",
    "minNav":"1",
    "loading":"1",
    "hotWords":"baidu",
    "classColumns":" col-sm-6 col-md-4 col-xl-5a col-xxl-6a ",
};
</script>

<!-- 360前端资源库 https://cdn.baomitu.com/ -->
<script crossorigin="anonymous" integrity="sha384-xBuQ/xzmlsLoJpyjoggmTEz8OWUFM0/RC5BsqQBDX2v5cMvDHcMakNTNrHIW2I5f" src="//lib.baomitu.com/jquery/3.2.1/jquery.min.js"></script>
<script crossorigin="anonymous" integrity="sha512-UfSxwRR8LlT3e4VLW1fx76+guLBWBALrK5mo7aJ92ZGiqGiR2Cu2AWgQ1FMLthwh2MbBVR0PqUCNiG6/QzsQNA==" src="//lib.baomitu.com/limonte-sweetalert2/11.7.27/sweetalert2.all.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-Zm+UU4tdcfAm29vg+MTbfu//q5B/lInMbMCr4T8c9rQFyOv6PlfQYpB5wItcXWe7" src="//lib.baomitu.com/fancybox/3.5.7/jquery.fancybox.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-UO2eT0CpHqdSJQ6hJty5KVphtPhzWj9WO1clHTMGa3JDZwrnQq4sF86dIHNDz0W1" src="//lib.baomitu.com/popper.js/1.14.7/umd/popper.min.js"></script>
<script crossorigin="anonymous" integrity="sha384-JjSmVgyd0p3pXB1rRibZUAYoIIy6OrQ6VrjIEaFf/nJGzIxFDsf4x0xIM+B07jRM" src="//lib.baomitu.com/twitter-bootstrap/4.3.1/js/bootstrap.min.js"></script>

<!-- 自定义 JS -->
{{ $alertify := resources.Get "js/alertify.min.js" | fingerprint}}
<script type='text/javascript' src="{{ $alertify.RelPermalink }}"></script>
{{ $spiderbox := resources.Get "js/spiderbox.js" | fingerprint}}
<script type='text/javascript' src="{{ $spiderbox.RelPermalink }}"></script>
{{ $app := resources.Get "js/app.js" | resources.Minify | fingerprint}}
<script type='text/javascript' src='{{ $app.RelPermalink }}' id='app-js'></script>
{{ $contentSearch := resources.Get "js/content-search.js" | resources.Minify | fingerprint}}
<script type="text/javascript" src="{{ $contentSearch.RelPermalink }}" id="content-search-js"></script>
{{ $localSearch := resources.Get "js/local-search.js" | resources.Minify | fingerprint}}
<script type="text/javascript" src="{{ $localSearch.RelPermalink }}" id="local-search-js"></script>
{{ if .Site.Params.pinyin.enable }}
{{ $pinyinPro := resources.Get "js/pinyin-pro-3.19.0.min.js" | fingerprint}}
<script type="text/javascript" src="{{ $pinyinPro.RelPermalink }}" id="pinyin-pro-js"></script>
{{ end }}

<script type="text/javascript">
    $(document).ready(function(){
        var siteWelcome = $('#loading');
        siteWelcome.addClass('close');
        setTimeout(function() {
            siteWelcome.remove();
        }, 600);
    });
</script>
<script>        
    $(document).ready(function(){
        setTimeout(function () {
            var hash = window.location.hash;
            if (hash) {
                console.log('[Init] 页面加载，检测hash:', hash);
                
                // 优先检查是否为标签（TLS-Toolbox逻辑）
                if (hash.indexOf('-tab-') > -1) {
                    var $tabItem = $(hash);
                    if ($tabItem.length && $tabItem.hasClass('tab-item')) {
                        console.log('[Init] 找到标签，激活中...');
                        $tabItem.click();
                        
                        // 滚动到标签位置
                        setTimeout(function() {
                            var pos = $tabItem.offset().top - 100;
                            $("html, body").animate({
                                scrollTop: pos
                            }, 200);
                        }, 100);
                        return;
                    }
                }
                
                // 否则尝试普通smooth链接
                if ($('a.smooth[href="' + hash + '"]')[0]) {
                    $('a.smooth[href="' + hash + '"]').click();
                } else if ($(hash).length) {
                    // 普通锚点滚动
                    $("html, body").animate({
                        scrollTop: $(hash).offset().top - 90
                    }, {
                        duration: 500,
                        easing: "swing"
                    });
                }
            }
        }, 300);
        $(document).on('click','a.smooth',function(ev) {
            if($('#sidebar').hasClass('show') && !$(this).hasClass('change-href')){
                $('#sidebar').modal('toggle');
            }
            
            var href = $(this).attr("href");
            if(href && href.substr(0, 1) == "#"){
                // 检查是否为二级菜单标签（移植自TLS-Toolbox逻辑）
                if (href.indexOf('-tab-') > -1) {
                    console.log('[Smooth] 检测到标签链接:', href);
                    
                    // 立即激活对应标签
                    var $tabItem = $(href);
                    if ($tabItem.length && $tabItem.hasClass('tab-item')) {
                        $tabItem.click();
                        console.log('[Smooth] 标签已激活');
                    }
                    
                    // 滚动到标签位置
                    var pos = $(href).offset().top - 100;
                    $("html, body").animate({
                        scrollTop: pos
                    }, 200); // 减少动画时间，提高响应速度
                    
                    return false;
                } else {
                    // 普通锚点滚动
                    $("html, body").animate({
                        scrollTop: $(href).offset().top - 90
                    }, {
                        duration: 500,
                        easing: "swing"
                    });
                }
            }
            
            if($(this).hasClass('go-search-btn')){
                $('#search-text').focus();
            }
            
            // 只有当目标不是标签时，才执行原有的menu逻辑
            if(!$(this).hasClass('change-href') && href.indexOf('-tab-') === -1){
                var menu =  $("a"+$(this).attr("href"));
                if(menu.length){
                    menu.click();
                    toTarget(menu.parent().parent(),true,true);
                }
            }
        });
        $(document).on('click','a.tab-noajax',function(ev) {
            var url = $(this).data('link');
            if(url)
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').show().attr('href', url);
            else
                $(this).parents('.d-flex.flex-fill.flex-tab').children('.btn-move.tab-move').hide();
        });
        
    });
</script>
<!--<script>
    window.addEventListener('DOMContentLoaded', (event) => {
        const cn = new CanvasNest(document.getElementById('search-bg'), {
            color: '255,255,255',
            pointColor: '255,255,255',
            opacity: 1,
            count: 30,
            zIndex: 1
        });
    });
</script>-->
</body>
</html>
